# ============================================
# 应用基础配置
# 公共配置已抽取到 Nacos: pet-vet-gateway-common.yml
# 如果 Nacos 不可用，本地配置会作为备用
# ============================================

spring:
  application:
    name: pet-vet-gateway
  # 强制使用响应式 Web 应用类型，解决 Spring Cloud Gateway 与 Spring MVC 冲突问题
  # Spring Cloud Gateway 基于 WebFlux，不能与 spring-boot-starter-web 共存
  main:
    web-application-type: reactive
  profiles:
    active: ${SPRING_PROFILES_ACTIVE:dev} # 默认激活 dev，可通过启动参数或环境变量覆盖
  config:
    # Spring Boot 3.x 需要显式导入 Nacos 配置
    # optional: 表示如果 Nacos 不可用，不会阻塞应用启动，会使用本地配置作为备用
    import:
      - optional:nacos:pet-vet-gateway-common.yml?group=DEFAULT_GROUP
      - optional:nacos:pet-vet-gateway-${spring.profiles.active}.yml?group=DEFAULT_GROUP
  cloud:
    # Nacos 基础配置（用于连接 Nacos，如果 Nacos 不可用，本地配置会作为备用）
    nacos:
      discovery:
        server-addr: ${NACOS_SERVER_ADDR:127.0.0.1:8848}
        # namespace: 空字符串表示 public 命名空间，dev 环境会从 Nacos 配置中覆盖
        namespace: ${NACOS_NAMESPACE:}
        group: DEFAULT_GROUP
        # 服务注册配置（本地开发环境）
        ip: ${NACOS_DISCOVERY_IP:127.0.0.1}
        enabled: true
      config:
        server-addr: ${NACOS_SERVER_ADDR:127.0.0.1:8848}
        namespace: ${NACOS_NAMESPACE:}
        group: DEFAULT_GROUP
        file-extension: yml

