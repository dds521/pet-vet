# RAG 模块配置检查清单

## @Value 配置项检查

### ✅ 已配置的项

#### 1. LangChainConfig 配置（spring.ai.*）
- ✅ `spring.ai.provider.type` - AI提供商类型
- ✅ `spring.ai.openai.api-key` - OpenAI API Key
- ✅ `spring.ai.openai.chat.options.model` - OpenAI 模型名称
- ✅ `spring.ai.openai.chat.options.temperature` - OpenAI 温度
- ✅ `spring.ai.deepseek.api-key` - DeepSeek API Key
- ✅ `spring.ai.deepseek.base-url` - DeepSeek Base URL
- ✅ `spring.ai.deepseek.chat.options.model` - DeepSeek 模型名称
- ✅ `spring.ai.deepseek.chat.options.temperature` - DeepSeek 温度
- ✅ `spring.ai.grok.api-key` - Grok API Key
- ✅ `spring.ai.grok.base-url` - Grok Base URL
- ✅ `spring.ai.grok.chat.options.model` - Grok 模型名称
- ✅ `spring.ai.grok.chat.options.temperature` - Grok 温度

#### 2. RAG 配置（rag.*）

**MemoryService:**
- ✅ `rag.memory.window-size` - 对话窗口大小（默认10）
- ✅ `rag.memory.ttl-days` - Redis过期时间（默认30天）

**QueryClassifier:**
- ✅ `rag.retrieval.force-retrieval-keywords` - 强制检索关键词
- ✅ `rag.retrieval.skip-retrieval-keywords` - 跳过检索关键词
- ✅ `rag.retrieval.default-retrieval` - 默认检索策略（默认true）

**RagValidationService:**
- ✅ `rag.generation.prompt-template` - 提示词模板
- ✅ `rag.retrieval.min-retrieval-score` - 最小检索分数阈值（默认0.6）

**RagService:**
- ✅ `rag.generation.prompt-template` - 提示词模板（与RagValidationService共享）

## 配置文件位置

所有配置都在 `pet-vet-rag-common.yml` 中，这是公共配置文件，所有环境共享。

## 配置说明

### rag.memory.*
- `window-size`: 控制保留多少轮对话历史（每轮包含USER和ASSISTANT两条消息）
- `ttl-days`: Redis中对话记忆的过期时间

### rag.retrieval.*
- `min-retrieval-score`: 检索结果的最低相似度分数，低于此值不使用检索结果
- `force-retrieval-keywords`: 包含这些关键词的查询必须进行检索
- `skip-retrieval-keywords`: 包含这些关键词的查询跳过检索
- `default-retrieval`: 默认是否进行检索（true/false）

### rag.generation.*
- `prompt-template`: 用于生成答案的提示词模板，支持 {context} 和 {question} 占位符

## 环境变量配置

以下配置通过环境变量设置（不在Nacos中）：
- `DEEPSEEK_API_KEY` - DeepSeek API密钥
- `OPENAI_API_KEY` - OpenAI API密钥
- `GROK_API_KEY` - Grok API密钥
- `AI_PROVIDER_TYPE` - AI提供商类型（deepseek/openai/grok）

## 验证方法

1. 启动应用后，检查日志中是否有配置加载信息
2. 使用 `/actuator/configprops` 端点查看配置属性（如果启用了actuator）
3. 检查应用启动日志中的配置值

